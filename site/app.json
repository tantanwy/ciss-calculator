[{"name": "app.py", "content": "from shiny import App, reactive, render, ui, run_app\nfrom typing import List\n\napp_ui = ui.page_fluid(\n    ui.tags.style(),\n    ui.h2(\"Cognitive Impairment Scoring System (CISS) Calculator\"),\n    ui.layout_sidebar(\n        # Side Bar object\n        ui.sidebar(\n            ui.h3(\"I. Patient Characteristics\"),\n            ui.input_radio_buttons(\n                \"sex\", \"Gender\", choices=[\"Female\", \"Male\"], selected=\"Female\"\n            ),\n            ui.input_slider(\n                \"age\", \"Age\", min=45, max=115, value=65, step=1, ticks=True\n            ),\n            ui.input_select(\n                \"race\",\n                \"Ethnicity\",\n                {\"0\": \"Chinese\", \"1\": \"Malay\", \"2\": \"Indian\", \"3\": \"Others\"},\n            ),\n            ui.input_select(\n                \"edu\",\n                \"Education (years)\",\n                {\n                    \"0\": \"No formal education\",\n                    \"1\": \"Primary (1-6 years)\",\n                    \"2\": \"Secondary (7-12 years)\",\n                    \"3\": \"Tertiary (>12 years)\",\n                },\n            ),\n            # BMI: 10\u201360, default 21, step 1 (adjust step if needed)\n            ui.input_slider(\n                \"bmi\",\n                \"Body mass index (BMI) kg/m2\",\n                min=10,\n                max=60,\n                value=21,\n                step=1,\n                ticks=True,\n            ),\n            ui.input_radio_buttons(\n                \"smoke\", \"Smoking\", choices=[\"Current/Ever\", \"Never\"], selected=\"Never\"\n            ),\n            ui.input_select(\n                \"sbp\",\n                \"Blood Pressure Systolic (mmHg)\",\n                {\"0\": \"< 140\", \"1\": \"140 \u2013 160\", \"2\": \"> 160\"},\n            ),\n            ui.input_radio_buttons(\n                \"dm\", \"Diabetes\", choices=[\"Present\", \"Absent\"], selected=\"Absent\"\n            ),\n            ui.input_radio_buttons(\n                \"hld\",\n                \"High cholesterol\",\n                choices=[\"Present\", \"Absent\"],\n                selected=\"Absent\",\n            ),\n            ui.input_radio_buttons(\n                \"stroke\", \"Have stroke history\", choices=[\"Yes\", \"No\"], selected=\"No\"\n            ),\n            ui.input_slider(\n                \"GDS\", \"GDS score\", min=0, max=20, value=0, step=1, ticks=True\n            ),\n            ui.input_action_button(\"action_button\", \"Start\"),\n            width=400,\n            style=\"background-color:#f5f5f5; border-right:1px solid #e0e0e0; padding:16px;\",\n        ),\n\n        \n        ui.navset_tab(\n            ui.nav_panel(\n                \"Main\",\n                ui.h2(\"Calculated CISS Scores\"),\n                ui.card(\n                    ui.row(\n                        ui.column(6,\n                            ui.h4(\"Basic Score (Max 100):\"),\n                            ui.span(\n                                ui.output_text(\"basic_score\", inline=True),\n                                style=\"font-size: 24px; color: #1E88E5; font-weight: bold;\"\n                            )\n                        ),\n                        ui.column(6,\n                            ui.h4(\"Likelihood of CIND\"),\n                            ui.span(\n                                ui.output_text(\"prob\", inline=True),\n                                style=\"font-size: 24px; color: #D81B60; font-weight: bold;\"\n                            )\n                        )\n                    )\n                ),\n                ui.hr(),\n                ui.h3(\"Score Interpretation\"),\n                ui.p(\"The CISS estimate the likelihood of cognitive impairment. A higher score indicates a higher risk.\"),\n                ui.p(\"Risk categories based on Basic Score:\"),\n                ui.tags.ul(\n                    ui.tags.li(\"Low risk: Basic Score < 35\"),\n                    ui.tags.li(\"Intermediate risk: Basic Score 36\u201350\"),\n                    ui.tags.li(\"High risk: Basic Score > 50\"),\n                ),\n                ui.h3(\"Clinical action\"),\n                ui.strong(ui.output_text(\"clinical_action\", inline=True)),\n                ui.p(\n                    ui.strong(\"Note:\"),\n                    \" This calculator only serve as a guide for assessing cognitive impairment and and should not be used as a replacement for professional medical evaluation.\",\n                    style=\"margin-top: 5rem; font-size: 0.9rem;\"\n                ),\n            ),\n        ui.nav_panel(\n            \"About\",\n            ui.h2(\"Introduction\"),\n            ui.p(\"TThis calculator computes the likelihood of Cognitive Impairment for the general population based on 11 factors.\"),\n            ui.h2(\"Instructions\"),\n            ui.tags.ol(\n                ui.tags.li(\"Enter information at left side bar\"),\n                ui.tags.li(\"Click Start to compute the score\"),\n                ui.tags.li(\"Gather scores, interpret and check clincal action\"),\n                ),\n            ui.p(\n                ui.strong(\"Source:\"),\n                \" Tan et al. A point-based cognitive impairment scoring system for southeast Asian adults. \",\n                \"JPAD. 2025 Apr 1;12(4):100069. \",\n                ui.a(\"https://doi.org/10.1016/j.tjpad.2025.100069\", href=\"https://doi.org/10.1016/j.tjpad.2025.100069\"),\n                style=\"margin-top: 10rem; font-size: 0.7rem;\"\n            ),)\n        )\n    )  # <-- closes ui.layout_sidebar\n)    # <-- closes ui.page_fluid\n\n# --- Server Logic Definition ---\n\n\ndef server(input, output, session):\n    from shiny import reactive, render\n\n    # Reactive expression to calculate the CISS scores\n    @reactive.Calc\n    @reactive.event(input.action_button)  # run only when Start is clicked\n    def calculate_ciss():\n        basic_score = 0\n\n        # Age\n        age = input.age()\n        if 60 <= age <= 75:\n            basic_score += 9\n        elif age > 75:\n            basic_score += 15\n\n        # Sex\n        if input.sex() == \"Female\":\n            basic_score += 3\n\n        # Ethnicity (non-Chinese)\n        if input.race() != \"0\":\n            basic_score += 10\n\n        # BMI\n        bmi = float(input.bmi())\n        if bmi < 18.5:\n            basic_score += 11\n        elif bmi <= 30:\n            basic_score += 0\n        else:  # >30\n            basic_score += 6\n\n        # Education\n        edu = input.edu()\n        if edu in (\"0\", \"1\"):  # \u22646 years\n            basic_score += 12\n        elif edu == \"2\":  # 7\u201312 years\n            basic_score += 4\n        # Else (e.g., \"3\" tertiary >12 years): 0 points\n\n        # SBP categories: \"0\" <140, \"1\" 140\u2013160, \"2\" >160\n        sbp_cat = input.sbp()\n        if sbp_cat == \"1\":\n            basic_score += 4\n        elif sbp_cat == \"2\":\n            basic_score += 11\n\n        if input.smoke() == \"Current/Former\":\n            basic_score += 5\n\n        if input.dm() == \"Present\":\n            basic_score += 8\n        if input.hld() == \"Present\":\n            basic_score += 7\n        if input.stroke() == \"Yes\":\n            basic_score += 9\n\n        gds = input.GDS()\n        if gds > 0:\n            basic_score += 9\n\n        return {\"basic\": basic_score}\n\n    # Output the Basic Score\n    @output\n    @render.text\n    def basic_score():\n        return str(calculate_ciss()[\"basic\"])\n\n    @output\n    @render.text\n    def clinical_action():\n        score = calculate_ciss()[\"basic\"]\n        if score < 35:\n            return \"To follow-up in 12 months\"\n        elif score > 50:\n            return \"To be referred to specialist clinic\"\n        else:\n            return \"To encourage lifestyle modification and follow-up in 6 months\"\n\n    @output\n    @render.text\n    def prob():\n        score = calculate_ciss()[\"basic\"]\n    \n        if 0 <= score <= 4:\n            return \"6%\"\n        elif 5 <= score <= 10:\n            return \"8%\"\n        elif 10 < score <= 14:  # 10 maps to 8% per previous range\n            return \"13%\"\n        elif 15 <= score <= 19:\n            return \"19%\"\n        elif 20 <= score <= 24:\n            return \"28%\"\n        elif 25 <= score <= 29:\n            return \"38%\"\n        elif 30 <= score <= 34:\n            return \"50%\"\n        elif 35 <= score <= 39:\n            return \"61%\"\n        elif 40 <= score <= 44:\n            return \"72%\"\n        elif 45 <= score <= 49:\n            return \"80%\"\n        elif 50 <= score <= 54:\n            return \"87%\"\n        elif score >= 55:\n            return \"> 90%\"\n        else:\n            return \"N/A\"\n\napp = App(app_ui, server)\n", "type": "text"}, {"name": "CISS_app.py", "content": "from shiny import App, reactive, render, ui, run_app\nfrom typing import List\n\napp_ui = ui.page_fluid(\n    ui.tags.style(),\n    ui.h2(\"Cognitive Impairment Scoring System (CISS) Calculator\"),\n    ui.layout_sidebar(\n        # Side Bar object\n        ui.sidebar(\n            ui.h3(\"I. Patient Characteristics\"),\n            ui.input_radio_buttons(\n                \"sex\", \"Gender\", choices=[\"Female\", \"Male\"], selected=\"Female\"\n            ),\n            ui.input_slider(\n                \"age\", \"Age\", min=45, max=115, value=65, step=1, ticks=True\n            ),\n            ui.input_select(\n                \"race\",\n                \"Ethnicity\",\n                {\"0\": \"Chinese\", \"1\": \"Malay\", \"2\": \"Indian\", \"3\": \"Others\"},\n            ),\n            ui.input_select(\n                \"edu\",\n                \"Education (years)\",\n                {\n                    \"0\": \"No formal education\",\n                    \"1\": \"Primary (1-6 years)\",\n                    \"2\": \"Secondary (7-12 years)\",\n                    \"3\": \"Tertiary (>12 years)\",\n                },\n            ),\n            # BMI: 10\u201360, default 21, step 1 (adjust step if needed)\n            ui.input_slider(\n                \"bmi\",\n                \"Body mass index (BMI) kg/m2\",\n                min=10,\n                max=60,\n                value=21,\n                step=1,\n                ticks=True,\n            ),\n            ui.input_radio_buttons(\n                \"smoke\", \"Smoking\", choices=[\"Current/Ever\", \"Never\"], selected=\"Never\"\n            ),\n            ui.input_select(\n                \"sbp\",\n                \"Blood Pressure Systolic (mmHg)\",\n                {\"0\": \"< 140\", \"1\": \"140 \u2013 160\", \"2\": \"> 160\"},\n            ),\n            ui.input_radio_buttons(\n                \"dm\", \"Diabetes\", choices=[\"Present\", \"Absent\"], selected=\"Absent\"\n            ),\n            ui.input_radio_buttons(\n                \"hld\",\n                \"High cholesterol\",\n                choices=[\"Present\", \"Absent\"],\n                selected=\"Absent\",\n            ),\n            ui.input_radio_buttons(\n                \"stroke\", \"Have stroke history\", choices=[\"Yes\", \"No\"], selected=\"No\"\n            ),\n            ui.input_slider(\n                \"GDS\", \"GDS score\", min=0, max=20, value=0, step=1, ticks=True\n            ),\n            ui.input_action_button(\"action_button\", \"Start\"),\n            width=400,\n            style=\"background-color:#f5f5f5; border-right:1px solid #e0e0e0; padding:16px;\",\n        ),\n\n        \n        ui.navset_tab(\n            ui.nav_panel(\n                \"Main\",\n                ui.h2(\"Calculated CISS Scores\"),\n                ui.card(\n                    ui.row(\n                        ui.column(6,\n                            ui.h4(\"Basic Score (Max 100):\"),\n                            ui.span(\n                                ui.output_text(\"basic_score\", inline=True),\n                                style=\"font-size: 24px; color: #1E88E5; font-weight: bold;\"\n                            )\n                        ),\n                        ui.column(6,\n                            ui.h4(\"Likelihood of CIND\"),\n                            ui.span(\n                                ui.output_text(\"prob\", inline=True),\n                                style=\"font-size: 24px; color: #D81B60; font-weight: bold;\"\n                            )\n                        )\n                    )\n                ),\n                ui.hr(),\n                ui.h3(\"Score Interpretation\"),\n                ui.p(\"The CISS estimate the likelihood of cognitive impairment. A higher score indicates a higher risk.\"),\n                ui.p(\"Risk categories based on Basic Score:\"),\n                ui.tags.ul(\n                    ui.tags.li(\"Low risk: Basic Score < 35\"),\n                    ui.tags.li(\"Intermediate risk: Basic Score 36\u201350\"),\n                    ui.tags.li(\"High risk: Basic Score > 50\"),\n                ),\n                ui.h3(\"Clinical action\"),\n                ui.strong(ui.output_text(\"clinical_action\", inline=True)),\n                ui.p(\n                    ui.strong(\"Note:\"),\n                    \" This calculator only serve as a guide for assessing cognitive impairment and and should not be used as a replacement for professional medical evaluation.\",\n                    style=\"margin-top: 5rem; font-size: 0.9rem;\"\n                ),\n            ),\n        ui.nav_panel(\n            \"About\",\n            ui.h2(\"Introduction\"),\n            ui.p(\"TThis calculator computes the likelihood of Cognitive Impairment for the general population based on 11 factors.\"),\n            ui.h2(\"Instructions\"),\n            ui.tags.ol(\n                ui.tags.li(\"Enter information at left side bar\"),\n                ui.tags.li(\"Click Start to compute the score\"),\n                ui.tags.li(\"Gather scores, interpret and check clincal action\"),\n                ),\n            ui.p(\n                ui.strong(\"Source:\"),\n                \" Tan et al. A point-based cognitive impairment scoring system for southeast Asian adults. \",\n                \"JPAD. 2025 Apr 1;12(4):100069. \",\n                ui.a(\"https://doi.org/10.1016/j.tjpad.2025.100069\", href=\"https://doi.org/10.1016/j.tjpad.2025.100069\"),\n                style=\"margin-top: 10rem; font-size: 0.7rem;\"\n            ),)\n        )\n    )  # <-- closes ui.layout_sidebar\n)    # <-- closes ui.page_fluid\n\n# --- Server Logic Definition ---\n\n\ndef server(input, output, session):\n    from shiny import reactive, render\n\n    # Reactive expression to calculate the CISS scores\n    @reactive.Calc\n    @reactive.event(input.action_button)  # run only when Start is clicked\n    def calculate_ciss():\n        basic_score = 0\n\n        # Age\n        age = input.age()\n        if 60 <= age <= 75:\n            basic_score += 9\n        elif age > 75:\n            basic_score += 15\n\n        # Sex\n        if input.sex() == \"Female\":\n            basic_score += 3\n\n        # Ethnicity (non-Chinese)\n        if input.race() != \"0\":\n            basic_score += 10\n\n        # BMI\n        bmi = float(input.bmi())\n        if bmi < 18.5:\n            basic_score += 11\n        elif bmi <= 30:\n            basic_score += 0\n        else:  # >30\n            basic_score += 6\n\n        # Education\n        edu = input.edu()\n        if edu in (\"0\", \"1\"):  # \u22646 years\n            basic_score += 12\n        elif edu == \"2\":  # 7\u201312 years\n            basic_score += 4\n        # Else (e.g., \"3\" tertiary >12 years): 0 points\n\n        # SBP categories: \"0\" <140, \"1\" 140\u2013160, \"2\" >160\n        sbp_cat = input.sbp()\n        if sbp_cat == \"1\":\n            basic_score += 4\n        elif sbp_cat == \"2\":\n            basic_score += 11\n\n        if input.smoke() == \"Current/Former\":\n            basic_score += 5\n\n        if input.dm() == \"Present\":\n            basic_score += 8\n        if input.hld() == \"Present\":\n            basic_score += 7\n        if input.stroke() == \"Yes\":\n            basic_score += 9\n\n        gds = input.GDS()\n        if gds > 0:\n            basic_score += 9\n\n        return {\"basic\": basic_score}\n\n    # Output the Basic Score\n    @output\n    @render.text\n    def basic_score():\n        return str(calculate_ciss()[\"basic\"])\n\n    @output\n    @render.text\n    def clinical_action():\n        score = calculate_ciss()[\"basic\"]\n        if score < 35:\n            return \"To follow-up in 12 months\"\n        elif score > 50:\n            return \"To be referred to specialist clinic\"\n        else:\n            return \"To encourage lifestyle modification and follow-up in 6 months\"\n\n    @output\n    @render.text\n    def prob():\n        score = calculate_ciss()[\"basic\"]\n    \n        if 0 <= score <= 4:\n            return \"6%\"\n        elif 5 <= score <= 10:\n            return \"8%\"\n        elif 10 < score <= 14:  # 10 maps to 8% per previous range\n            return \"13%\"\n        elif 15 <= score <= 19:\n            return \"19%\"\n        elif 20 <= score <= 24:\n            return \"28%\"\n        elif 25 <= score <= 29:\n            return \"38%\"\n        elif 30 <= score <= 34:\n            return \"50%\"\n        elif 35 <= score <= 39:\n            return \"61%\"\n        elif 40 <= score <= 44:\n            return \"72%\"\n        elif 45 <= score <= 49:\n            return \"80%\"\n        elif 50 <= score <= 54:\n            return \"87%\"\n        elif score >= 55:\n            return \"> 90%\"\n        else:\n            return \"N/A\"\n\napp = App(app_ui, server)\n", "type": "text"}]